



















#include "includes.h"






























































































































































































































































































































































































































































































































/*----------------------------------------------------------------------------------------------*/
/* Form the CCSDS packet header with the given _apid, sequence flag, and packet length, and command bit */
void FormCCSDSPacketHeader(CCSDS_Packet_Header *_p, uint32 _apid, uint32 _sf, uint32 _pl, uint32 _cm, uint32 _tic)
{

	_p->pid = ((_cm & 0x1) << 12) + ((_apid + CCSDS_APID_BASE) & 0x7FF);//_p->pid = ((_cm & 0x1) << 12) + (_apid + CCSDS_APID_BASE) & 0x7FF;
	_p->psc = (_sf & 0x3) + ((_tic & 0x3FFF) << 2);
	_p->pdl = _pl & 0xFFFF;

}













/*----------------------------------------------------------------------------------------------*/
#define MOD_ADLER 65521
/* Data is input buffer, len is in bytes! */
uint32 adler(uint8 *data, int32 len)
{

    uint32 a, b;
//	int32 tlen;

    a = 1; b = 0;

    if(len < 5552)
    {
        do
        {
            a += *data++;
            b += a;
        } while (--len);

        a %= MOD_ADLER;
        b %= MOD_ADLER;
    }

    return (b << 16) | a;

}
/*----------------------------------------------------------------------------------------------*/

//VIO
/*----------------------------------------------------------------------------------------------*/
/* Mimicing sensor_msgs.header.toSec(). Borrowed from rKimera_VIO */
double toSec(int64_t header_stamp)
{
	return double(header_stamp) * 0.000000001;
}
/*----------------------------------------------------------------------------------------------*/
